<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   NYP Chess Club
  </title>
  <link href="css/style.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
   .error-message {
      color: red;
      font-size: 0.9rem;
      margin-top: 4px;
    }
  </style>
 </head>
 <body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-lg">
   <div class="container">
    <a class="navbar-brand d-flex align-items-center" data-target-page="home.html" href="/">
     <img src="images/logo.png" alt="NYP Chess Club Logo" class="logo-img">
     <span>
      NYP Chess Club
     </span>
    </a>
    <button class="navbar-toggler" data-bs-target="#navbarNav" data-bs-toggle="collapse" type="button">
     <span class="navbar-toggler-icon">
     </span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
     <ul class="navbar-nav">
      <li class="nav-item">
       <a class="nav-link" data-target-page="home.html" href="/">
        Home
       </a>
      </li>
      <li class="nav-item">
       <a class="nav-link" data-target-page="about.html" href="about.html">
        About
       </a>
      </li>
      <li class="nav-item">
       <a class="nav-link" data-target-page="learn.html" href="learn.html">
        Learn
       </a>
      </li>
      <li class="nav-item">
       <a class="nav-link" data-target-page="event.html" href="event.html">
        Event
       </a>
      </li>
      <li class="nav-item">
       <a class="nav-link" data-target-page="contact.html" href="contact.html">
        Contact
       </a>
      </li>
      <li class="nav-item">
       <a class="btn btn-warning ms-3 fw-bold" data-target-page="join.html" href="join.html">
        Join
       </a>
      </li>
     </ul>
    </div>
   </div>
  </nav>
  <!-- countdown timer display -->
  <div class="fw-bold fs-4 text-danger text-center py-3" id="countdown-timer">
  </div>
  <div id="dynamic-content">
  </div>
  <footer class="bg-primary text-warning py-5" style="background-color:#0a1930 !important;">
   <div class="container">
    <div class="row">
     <div class="col-md-4">
      <h5 class="fw-bold text-warning">
       NYP Chess Club
      </h5>
      <p>
       We're a community that loves chess, and we hope you'll join us to learn, play, and have fun together!
      </p>
     </div>
     <div class="col-md-4">
      <h5 class="fw-bold text-warning">
       Quick Links
      </h5>
      <ul class="list-unstyled">
       <li>
        <a class="fw-semibold text-warning text-decoration-none" data-target-page="home.html" href="/">
         Home
        </a>
       </li>
       <li>
        <a class="fw-semibold text-warning text-decoration-none" data-target-page="about.html" href="about.html">
         About
        </a>
       </li>
       <li>
        <a class="fw-semibold text-warning text-decoration-none" data-target-page="learn.html" href="learn.html">
         Learn
        </a>
       </li>
       <li>
        <a class="fw-semibold text-warning text-decoration-none" data-target-page="event.html" href="event.html">
         Event
        </a>
       </li>
       <li>
        <a class="fw-semibold text-warning text-decoration-none" data-target-page="contact.html" href="contact.html">
         Contact
        </a>
       </li>
       <li>
        <a class="fw-semibold text-warning text-decoration-none" data-target-page="join.html" href="join.html">
         Join
        </a>
       </li>
      </ul>
     </div>
     <div class="col-md-4">
      <h5 class="fw-bold text-warning">
       Meeting Info
      </h5>
      <p>
       Tues &amp; Thurs
       <br/>
       3:30 PM - 4:30 PM
       <br/>
       Blk L, Level 3, Rm L315
       <br/>
       Nanyang Polytechnic
      </p>
     </div>
    </div>
    <div class="pt-4 text-center border-top mt-4 border-secondary">
     © 2025 NYP Chess Club. Part of NYP Student Activities.
    </div>
   </div>
  </footer>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
  </script>
  
  <script>
  // ===== Countdown Timer ===== 
  // Displays remaining time until NYP NDP Chess Competition
   const eventDate = new Date("2025-09-08T10:00:00");
function updateCountdown() {
  const now = new Date();
  const diff = eventDate - now;
  const timerEl = document.getElementById("countdown-timer");
  if (!timerEl) return;
  if (diff <= 0) {
    timerEl.textContent = "Event Started!";
    clearInterval(timer);
    return;
  }
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));
  const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
  const minutes = Math.floor((diff / (1000 * 60)) % 60);
  const seconds = Math.floor((diff / 1000) % 60);
  timerEl.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s left to NYP NDP Chess Competition`;
}
updateCountdown();
const timer = setInterval(updateCountdown, 1000);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js">
  </script>
  <!-- ===== SPA Loader =====  -->
  <!-- Dynamically loads page content without full reload -->
  <script>
   document.addEventListener("DOMContentLoaded", function () {
  const links = document.querySelectorAll("[data-target-page]");
  const dynamicContent = document.getElementById("dynamic-content");
// Fetch chess blitz rating from Chess.com API for a given username
async function fetchBlitzRating(username) {
  try {
    const res = await fetch(`https://api.chess.com/pub/player/${encodeURIComponent(username)}/stats`);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const data = await res.json();
    return data.chess_blitz?.last?.rating ?? "N/A";
  } catch (e) {
    console.error("fetchBlitzRating error:", e);
    return "Error";
  }
}
// Update all blitz ratings on the page
async function updateBlitzRatings() {
  const spans = document.querySelectorAll(".blitz-rating[data-username]");
  for (const span of spans) {
    span.textContent = "Loading...";
    const username = span.dataset.username;
    const rating = await fetchBlitzRating(username);
    span.textContent = rating;
  }
}
  // Main SPA loader function
  async function loadPage(page) {
    try {
      const response = await fetch(page.split("?")[0]);
      const html = await response.text();
      dynamicContent.innerHTML = html;

      // counter
      if (page === "home.html") {
        const counterEl = document.getElementById('gamesCounter');
        if (counterEl) {
          let count = 0;
          const target = 100;
          const speed = 20;
          const updateCounter = () => {
            if (count < target) {
              count++;
              counterEl.textContent = count;
              setTimeout(updateCounter, speed);
            } else {
              counterEl.textContent = target;
            }
          };
          updateCounter();
        }updateBlitzRatings();
//The quote can be randomized. For UX purpose, we decided fixed quote is better aesthetically
const quotes = [ 
  "I’ve never been much of a materialist. The joy of playing chess is enough. - Carlsen"
];

  const quoteElement = document.getElementById("quote");
  if (quoteElement) {
    const randomIndex = Math.floor(Math.random() * quotes.length);
    quoteElement.textContent = `“${quotes[randomIndex]}”`;
  }
      }

      // handling incline error
      if (page === "join.html") {
        const joinForm = document.getElementById('joinForm');
        const emailError = document.createElement('div');
        emailError.classList.add('error-message');
        document.getElementById('email').after(emailError);

        const phoneError = document.createElement('div');
        phoneError.classList.add('error-message');
        document.getElementById('phone').after(phoneError);
        // ===== Form Validation =====
        // Validates email and phone, triggers confetti on success
        if (joinForm) {
          joinForm.addEventListener('submit', function (e) {
            e.preventDefault();
            emailError.textContent = '';
            phoneError.textContent = '';

            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const school = document.getElementById('school').value.trim();

            let isValid = true;

            // check if email is actually a email
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/i;
            if (!emailPattern.test(email)) {
              emailError.textContent = "Please enter a valid email address.";
              isValid = false;
            }
            // check if phone number is actually a phone number. this require 8 digit number starting with 8 or 9
            const phonePattern = /^[89]\d{7}$/;
            if (!phonePattern.test(phone)) {
               phoneError.textContent = "Please enter an 8-digit number starting with 8 or 9."; 
               isValid = false;
            }

            if (!isValid) return;
            confetti({
  particleCount: 200,   // more particles
  spread: 90,           // wider spread
  origin: { y: 0.6 },
  scalar: 1.6           // make particles bigger
});

loadPage(`thankyou.html?name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}&phone=${encodeURIComponent(phone)}&school=${encodeURIComponent(school)}`);
          });
                }
                    }
                    
      // After submitting the form
      if (page.startsWith("thankyou.html")) {
        const queryString = page.split("?")[1] || "";
        const params = new URLSearchParams(queryString);
        const name = params.get('name');
        const email = params.get('email');
        const phone = params.get('phone');
        const school = params.get('school');
        const formDataDiv = document.getElementById('formData');
        if (formDataDiv) {
          formDataDiv.innerHTML = `
            <p><strong>Full Name:</strong> ${name || ''}</p>
            <p><strong>Email:</strong> ${email || ''}</p>
            <p><strong>Contact Number:</strong> ${phone || ''}</p>
            <p><strong>School:</strong> ${school || ''}</p>
          `;
        }
      }

    } catch (error) {
      dynamicContent.innerHTML = "<p>Error loading page.</p>";
    }
  }

  links.forEach(link => {
    link.addEventListener("click", function (e) {
      e.preventDefault();
      const page = this.getAttribute("data-target-page");
      history.pushState({ page }, "", this.getAttribute("href"));
      loadPage(page);
    });
  });

  window.addEventListener("popstate", function (e) {
    if (e.state && e.state.page) {
      loadPage(e.state.page);
    }
  });

  loadPage("home.html");
});
  </script>
 </body>
</html>
